# openshift 4.15, 新特性

ocp 4.15 好像新特性挺多的，值得我们单开一个文档，来学习和总结一下。

# upstream k8s

- [组件版本兼容](https://kubernetes.io/releases/version-skew-policy/)
  - 这个是在升级得时候，允许不同版本的组件在一起运行，这样就可以逐步升级了。
- [Non-Graceful Node Shutdown](https://kubernetes.io/blog/2023/08/16/kubernetes-1-28-non-graceful-node-shutdown-ga/)
  - 如果一个节点异常关机，那么pod，特别是statefule pod，可以顺利的迁移到别的node
  - 之前遇到过，节点异常关机，然后pod就处于一个非常尴尬的状态，也不关闭，也不重启，一直等着节点恢复正常，所以应用就处于不能迁移，不能启动，不能维护的状态
  - 这个新的特性，可以解决这个问题，但是方法也非常愚蠢，手动设置一个节点为异常。。。
```bash
kubectl taint nodes <node-name> node.kubernetes.io/out-of-service=nodeshutdown:NoExecute
```
- [Retroactive Default StorageClass](https://kubernetes.io/blog/2023/08/18/retroactive-default-storage-class-ga/)
  - 如果pvc没有指定storageclass，那么后面定义了默认的storageclass以后，系统会自动给这些pvc定义storageclass。
- [Consistent reads from cache](https://github.com/kubernetes/enhancements/issues/2340)
  - 默认情况下，k8s api server读取到的信息，并不一致，因为cache是eventual consistent的，但是未来可以读取到一致的信息，因为cache可以设置为strongly consistent
  - ConsistentListFromCache: Allow the API server to serve consistent lists from cache.
  - 现在还是alpha，不急
- 

